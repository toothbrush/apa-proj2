imports
{
import Data.Set (Set)
}

{
type TyVar  = String
type Var    = String
type Point  = Int
type AnnVar = String
}
-------------------------------------------------------------------------------
-- Syntax
-------------------------------------------------------------------------------

-- Language definition for Mini Haskell
DATA MH
  | VBool  v  : {Bool}
  | VInt   v  : {Integer}
  | Var    x  : {Var}
  | Lambda x  : {Var}     e  : MH
  | App    e1 : MH        e2 : MH
  | Let    x  : {Var}     e1 : MH e2 : MH
  | LetRec x  : {Var}     e1 : MH e2 : MH
  | If     c  : MH        e1 : MH e2 : MH
  | Cons   e1 : MH        e2 : MH
  | Nil

DERIVING MH: Show, Eq

DATA TyScheme
  | Ty     ty : Ty
  | Forall a  : {TyVar} ts : TyScheme

DERIVING TyScheme: Show, Eq

DATA Ty
  | TyVar a   : {TyVar}
  | Arr   ty1 : Ty      ty2 : Ty     ann : {SAnn}
  | List  ty  : Ty      ann : {SAnn}
  | Nat
  | Bool

DERIVING Ty: Show, Eq

DATA SAnn
  | AnnSet ns  : {Set Point}
  | AnnVar var : {AnnVar}

DERIVING SAnn: Show, Eq
